WORK_PATH = /data/gitea

# Gitea Configuration File for SSO via Nginx/Authelia
[server]
PROTOCOL = http
# <--- VERIFY THIS IS YOUR CURRENT IP
DOMAIN = 3.110.86.116
HTTP_PORT = 3000
# <--- VERIFY THIS IS YOUR CURRENT IP
ROOT_URL = https://3.110.86.116/gitea/
APP_SUB_URL = /gitea/
LFS_START_SERVER = true
OFFLINE_MODE = false
# Directs to explore page instead of marketing page if not authenticated
LANDING_PAGE = explore
LFS_JWT_SECRET = aHZRVxxsA_oLOW3Z57yHVWd0uPQ_QfSwNgrwVN6TMoo

[database]
# ABSOLUTELY ESSENTIAL: Tells Gitea it's already installed
INSTALLED = true
DB_TYPE = sqlite3
# Path inside the container's /data volume
PATH = /data/gitea/gitea.db

[repository]
# Path inside the container's /data volume
ROOT = /data/git/repositories

[log]
# Output logs to console for easy docker logs viewing
MODE = console
# Set to debug for more verbose logging if needed (then change back to info)
LEVEL = debug
# Path inside the container's /data volume
ROOT_PATH = /data/gitea/log

[service]
# === THIS SECTION IS THE KEY FOR SSO IN GITEA ===
# Disable Gitea's own registration and password login if proxying auth
DISABLE_REGISTRATION = true
# Usually set to false for SSO
REGISTER_EMAIL_CONFIRM = false
ENABLE_NOTIFY_MAIL = false
# These two were present, but might need to be explicitly defined for the auth source.
# They are often redundant when using an explicit auth source like below.
# ENABLE_HTTP_AUTH = true
# HTTP_AUTH_HEADER = X-Remote-User
# HTTP_AUTH_MAIL_HEADER = X-Remote-Email
# HTTP_AUTH_NAME_HEADER = X-Remote-Name
# Crucial for Gitea to force external login and NOT show its own login form.
# Disable Gitea's internal session-based auto-login
ENABLE_AUTO_LOGIN = false
# THIS IS THE NEW KEY: Forces Gitea to operate as a private instance requiring external authentication.
FORCE_PRIVATE_MODE = true

# This makes Gitea not serve any public pages (like marketing page) until logged in.
# It should directly hit Authelia or redirect to its login through the proxy.
[security]
# Prevents accidental re-installation via web UI
INSTALL_LOCK = true
# PASTE THE FIRST KEY YOU GENERATED HERE
SECRET_KEY = cafe49b0b3f78c1760d3407e78c0c7d53c37ce1d23c01fcc62e72ffcf8589523
# PASTE THE SECOND KEY YOU GENERATED HERE
INTERNAL_TOKEN = ca6c94eb5ea13bd9db5b15d4f9301ea5a0d52d3824a3feb16ef347968576a634
REVERSE_PROXY_LIMIT = 1
# Docker network range
REVERSE_PROXY_TRUSTED_PROXIES = 172.0.0.0/8

# NEW/MODIFIED: Explicit External Authentication Source (Added back this)
[auth.webauth.authelia]
ENABLED = true
NAME = Authelia SSO
# Type 1 means WebAuth (HTTP Header based)
TYPE = 1
HTTP_HEADERS = X-Remote-User
HTTP_HEADERS_EMAIL = X-Remote-Email
HTTP_HEADERS_DISPLAY_NAME = X-Remote-Name
AUTO_CREATE_USERS = true

[oauth2]
JWT_SECRET = l0fOdOBFUV1VOuz3wswZPlLrVoFijgvxHiFvP8zZ_aI
